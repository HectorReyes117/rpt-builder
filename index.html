<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="color-scheme" content="light dark"/>

    <link rel="stylesheet" href="/pico.css"/>
    <link rel="stylesheet" href="./src/style.css">

    <script src="./src/app.js" type="module" defer></script>
    <script defer src="/alpine.js"></script>

    <title>Rpt builder</title>
</head>

<body x-data="main">
<main style="display: flex; justify-content: space-between; height: 100%;">


    <svg style="position: absolute; z-index: 40" width="50" @click="openSideLeft" height="50" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6">
        <path stroke-linecap="round" stroke-linejoin="round" d="M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25h16.5" />
    </svg>
    <div style="padding-right: 1rem; z-index: 20" class="close-side-left" id="side-left">
        <div class="pico side-bar item-side-left">
            <select x-model="scale">
                <option value="100">100%</option>
                <option value="75">75%</option>
                <option value="50">50%</option>
                <option value="25">25%</option>
            </select>
            <p>
                Select the type of element to add:
            </p>
            <ul>
                <li><a href="#" @click="addItem('rpt-text')">Text</a></li>
                <li><a href="#" @click="addItem('rpt-img')">Image</a></li>
                <li><a href="#" @click="addItem('rpt-table')">table</a></li>
            </ul>
        </div>
    </div>

    <div class="pico" style="padding-top: 1rem; display: flex; justify-content: center; align-items: center; width: 100%; z-index: 10">
        <div
            class="report-container"
            :style="`min-width: ${report.width}; max-width: ${report.width}; min-height: ${report.height}; max-height: ${report.height}; scale: ${scale/100}`"
            @dragover="allowDrop(event)"
            @drop="onDrop(event)"
        >
            <template x-for="(i, idx) in report.elements" :key="idx">
                <div
                    x-html="`<div is='${i.type}' x-model='i.value' :element='JSON.stringify(i)' :idx='idx' @delete='destroy' @focus='onFocus'></div>`">
                </div>
            </template>
        </div>

<!--        <textarea :value="JSON.stringify(report)"></textarea>-->

    </div>

    <svg width="40" height="40" @click='openSideRight' style="position: fixed; right: 0; z-index: 40" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6">
        <path stroke-linecap="round" stroke-linejoin="round" d="M11.42 15.17 17.25 21A2.652 2.652 0 0 0 21 17.25l-5.877-5.877M11.42 15.17l2.496-3.03c.317-.384.74-.626 1.208-.766M11.42 15.17l-4.655 5.653a2.548 2.548 0 1 1-3.586-3.586l6.837-5.63m5.108-.233c.55-.164 1.163-.188 1.743-.14a4.5 4.5 0 0 0 4.486-6.336l-3.276 3.277a3.004 3.004 0 0 1-2.25-2.25l3.276-3.276a4.5 4.5 0 0 0-6.336 4.486c.091 1.076-.071 2.264-.904 2.95l-.102.085m-1.745 1.437L5.909 7.5H4.5L2.25 3.75l1.5-1.5L7.5 4.5v1.409l4.26 4.26m-1.745 1.437 1.745-1.437m6.615 8.206L15.75 15.75M4.867 19.125h.008v.008h-.008v-.008Z" />
    </svg>

    <rpt-sidebar-properties :element="JSON.stringify(report.elements[currentElementIdx])" :idx="currentElementIdx" @update="updateElement"></rpt-sidebar-properties>
</main>

<script>
    function changeTheme() {
        const theme = document.querySelector('html').getAttribute('data-theme') === 'light' ? 'dark' : 'light'
        document.querySelector('html').setAttribute('data-theme', theme)
    }
</script>
</body>

</html>
